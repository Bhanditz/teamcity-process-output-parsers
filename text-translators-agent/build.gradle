apply plugin: 'com.github.rodm.teamcity-agent'

teamcity {
    version = teamcityVersion

//    descriptor {
//        pluginDeployment {
//            useSeparateClassloader = true
//        }
//    }
    descriptor = project.file('teamcity-agent-plugin.xml')
}

dependencies {
    compile project(':regex-parser')

    provided("org.jetbrains.teamcity.internal:agent:${teamcityVersion}")

    provided("org.jetbrains.teamcity.internal.generated:server-logging:${teamcityVersion}")
    testCompile("org.jetbrains.teamcity.internal.generated:tests-integration:${teamcityVersion}")
}

test {
    useTestNG()
}

sourceSets {
    main {
        java {
            srcDirs 'src'
        }
        resources {
            srcDir 'resources'
        }
    }
    test {
        java {
            srcDir 'test'
        }
        resources {
            srcDir 'testData'
        }
    }
}